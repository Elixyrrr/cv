<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=cover">
  <title>{{ .Site.Title }} | {{ .Title }}</title>
  <meta name="description" content="{{ if .IsHome }}{{ .Site.Params.description }}{{else}}{{ .Description }}{{ end }}">
  <link rel="icon" type="image/png" href="/favicon.png" />

  <!-- =============== Styles =============== -->
  <style>
    /* ---------- Variables ---------- */
    :root{
      --accent:#64ffda;
      --accent-secondary:#00d4ff;
      --text-primary:#ccd6f6;
      --bg-card:rgba(255,255,255,.05);
      --border-color:rgba(100,255,218,.2);
    }

    /* ---------- Global ---------- */
    html,body{height:100%}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:'Open Sans', serif;
      color:#868e96;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      touch-action:manipulation;
      -webkit-tap-highlight-color:transparent;
      padding-top:54px;
      overflow-x:hidden;
    }
    @media (min-width:992px){
      body{padding-top:0;padding-left:17rem}
    }

    h1,h2,h3,h4,h5,h6{
      font-family:'Saira Extra Condensed', serif;
      font-weight:700;
      color:#343a40;
    }
    h1,h2{text-transform:uppercase}
    h1{font-size:6rem;line-height:5.5rem}
    h2{font-size:3.5rem}

    a{color:#00bfa8}
    a:hover,a:focus{color:#00bfa8}

    .text-primary{color:var(--accent)!important}

    /* ---------- Canvas plein écran ---------- */
    #nn-canvas{
      position:fixed;inset:0;
      width:100vw;height:100vh;
      z-index:-1;display:block;
    }

    /* ---------- Sections ---------- */
    section.resume-section{
      border-bottom:1px solid hsla(22,100%,96%,.082);
      padding-block:5rem !important;
    }
    @media (min-width:768px){
      section.resume-section{min-height:100vh}
    }
    @media (min-width:992px){
      section.resume-section{padding-block:3rem !important}
    }

    /* ---------- SideNav (Bootstrap override) ---------- */
    #sideNav .navbar-nav .nav-item .nav-link{
      font-weight:600;text-transform:uppercase
    }
    @media (min-width:992px){
      #sideNav{
        text-align:center;position:fixed;top:0;left:0;
        display:flex;flex-direction:column;width:17rem;height:100vh;
      }
      #sideNav .navbar-brand{display:flex;margin:auto auto 0;padding:.5rem}
      #sideNav .navbar-brand .img-profile{
        max-width:10rem;max-height:10rem;border:.5rem solid rgba(255,255,255,.2)
      }
      #sideNav .navbar-collapse{
        display:flex;align-items:flex-start;flex-grow:0;width:100%;margin-bottom:auto
      }
      #sideNav .navbar-collapse .navbar-nav{
        flex-direction:column;width:100%
      }
      .bg-primary{background:transparent !important;border-right:none !important;z-index:2}
    }
    @media (max-width:991.98px){
      .bg-primary{background:#138f75 !important;border:1px solid #138f75 !important;z-index:2}
    }

    /* ---------- Social icons visibility fix ---------- */
    .list-social-icons .list-inline-item{
      display:inline-block !important;opacity:1 !important;visibility:visible !important
    }
    .list-social-icons .fa-stack{display:inline-block !important;font-size:inherit !important}
    .fa-stack .fa-inverse{color:#fff !important}
    .fa-stack .fa-circle{color:rgba(0, 0, 0, 0.05) !important}

    /* ---------- Skills grid ---------- */
    #skills .dev-icons{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(120px,1fr));
      gap:16px;margin:0;padding:0;list-style:none;
    }

    /* ---------- Skill card ---------- */
    .list-inline-item{
      display:flex;flex-direction:column;align-items:center;
      padding:16px 12px;margin:0;
     
      position:relative;overflow:hidden;
 

      /* Entrée */
      opacity:0;transform:translateX(-150px) rotateY(-90deg) scale(.5);
      will-change:transform,opacity;
    }

    /* Apparition par IntersectionObserver */
    .list-inline-item.visible{
      animation:slideInWave .8s cubic-bezier(.175,.885,.32,1.275) forwards;
    }
    .list-inline-item:nth-child(1){animation-delay:.05s}
    .list-inline-item:nth-child(2){animation-delay:.1s}
    .list-inline-item:nth-child(3){animation-delay:.15s}
    .list-inline-item:nth-child(4){animation-delay:.2s}
    .list-inline-item:nth-child(5){animation-delay:.25s}
    .list-inline-item:nth-child(6){animation-delay:.3s}
    .list-inline-item:nth-child(7){animation-delay:.35s}
    .list-inline-item:nth-child(8){animation-delay:.4s}
    .list-inline-item:nth-child(9){animation-delay:.45s}
    .list-inline-item:nth-child(10){animation-delay:.5s}
    .list-inline-item:nth-child(11){animation-delay:.55s}
    .list-inline-item:nth-child(12){animation-delay:.6s}

    @keyframes slideInWave{
      0%{opacity:0;transform:translateX(-150px) rotateY(-90deg) scale(.5)}
      30%{opacity:.5;transform:translateX(-30px) rotateY(-30deg) scale(.8)}
      60%{opacity:.8;transform:translateX(20px) rotateY(15deg) scale(1.1)}
      80%{opacity:.95;transform:translateX(-5px) rotateY(-5deg) scale(1.05)}
      100%{opacity:1;transform:translateX(0) rotateY(0) scale(1)}
    }

    /* Hover (seulement sur devices avec hover) */
    @media (hover:hover){
      .list-inline-item:hover{
        transform:translateY(-15px) scale(1.08) rotateY(5deg);
        box-shadow:0 25px 50px rgba(100,255,218,.3), 0 0 30px rgba(100,255,218,.2);
        border-color:var(--accent);
        background:rgba(100,255,218,.1);
      }
    }

    /* Icons & images */
    .list-inline-item i,
    .list-inline-item .skill-image{
      font-size:2.5rem;width:48px;height:48px;margin-bottom:12px;
      color:var(--accent);
      transition:transform .5s cubic-bezier(.175,.885,.32,1.275), filter .5s, color .5s, text-shadow .5s;
      filter:brightness(.9);
      will-change:transform;
    }
    @media (hover:hover){
      .list-inline-item:hover i,
      .list-inline-item:hover .skill-image{
        transform:rotateY(360deg) scale(1.2);
        color:#fff;filter:brightness(1.2) drop-shadow(0 0 15px rgba(100,255,218,.6));
        text-shadow:0 0 20px rgba(100,255,218,.8);
      }
    }

    /* Nom/links */
    .skill-name,
    .list-inline-item a{
      font-size:.85rem;font-weight:600;text-transform:uppercase;letter-spacing:1px;
      color:var(--text-primary);text-decoration:none;text-align:center;position:relative;
      transition:color .3s ease,text-shadow .3s ease;
    }
    .skill-name::after,
    .list-inline-item a::after{
      content:'';position:absolute;bottom:-4px;left:50%;transform:translateX(-50%);
      width:0;height:2px;background:linear-gradient(90deg,var(--accent),var(--accent-secondary));
      transition:width .3s ease;
    }
    @media (hover:hover){
      .list-inline-item:hover .skill-name,
      .list-inline-item:hover a{color:var(--accent);text-shadow:0 0 10px rgba(100,255,218,.5)}
      .list-inline-item:hover .skill-name::after,
      .list-inline-item:hover a::after{width:100%}
    }

    /* Compacité dans sections about */
    .about-section .list-inline-item i,
    .about-section .skill-image,
    section[id*="about"] .list-inline-item i,
    section[id*="about"] .skill-image{
      font-size:2rem;width:40px;height:40px;margin-bottom:0;
    }

    /* ---------- Mobile first tuning ---------- */
    @media (max-width:768px){
      /* grille + padding */
      #skills .dev-icons{
        grid-template-columns:repeat(auto-fill,minmax(100px,1fr));
        gap:12px;padding:0 8px;
      }
      .list-inline-item{
        padding:10px 8px;border-radius:12px;
        backdrop-filter:none; 
        box-shadow:none;     
        transform:none;     
      }
      .list-inline-item i,
      .list-inline-item .skill-image{
        font-size:2rem;width:40px;height:40px;margin-bottom:8px;
      }
      .skill-name,
      .list-inline-item a{font-size:.8rem;line-height:1.2rem}

      /* Animation d’apparition simplifiée */
      .list-inline-item.visible{animation:fadeInUp .45s ease forwards}
      @keyframes fadeInUp{
        from{opacity:0;transform:translateY(18px)}
        to{opacity:1;transform:translateY(0)}
      }

      /* simul-hover au tap: léger zoom */
      .list-inline-item:active{
        transform:scale(1.03);
        box-shadow:0 10px 20px rgba(100,255,218,.2);
      }
      .list-inline-item:active i,
      .list-inline-item:active .skill-image{transform:scale(1.1)}
    }

    @media (max-width:480px){
      #skills .dev-icons{grid-template-columns:repeat(auto-fill,minmax(80px,1fr));gap:8px}
      .list-inline-item{padding:8px 6px}
      .list-inline-item i,
      .list-inline-item .skill-image{font-size:1.8rem;width:36px;height:36px}
      .skill-name{font-size:.75rem}
    }

    /* ---------- Accessibilité / perf ---------- */
    @media (prefers-reduced-motion:reduce){
      *{animation-duration:0.001ms !important;animation-iteration-count:1 !important;transition-duration:0.001ms !important;scroll-behavior:auto !important}
      .list-inline-item{opacity:1;transform:none}
    }

    /* ---------- Divers utilitaires d’origine ---------- */
    img{max-width:100% !important}
    .p-0{margin:0 auto}
    .devicons{font-size:1.5em;vertical-align:sub}
    .publication-content{width:90%}
    h3{margin-top:40px}
    h3.mb-0{margin-top:0}
    div.skills-heading{margin-top:1em;margin-bottom:0 !important}

    /* Tags (style existant simplifié) */
    .tags{list-style:none;margin:0;padding:0;overflow:hidden;font:12px/1.5 'PT Sans', serif}
    .tags li{float:left}
    .tag{
      display:inline-block;background:#eee;color:#333;border-radius:3px;
      height:26px;line-height:26px;padding:0 12px;margin:0 10px 10px 0;
      transition:background-color .2s,color .2s
    }
    .tag:hover{background-color:crimson;color:#fff}

    /* Googlebot tap target spacing */
    @media (max-width:768px){
      a{min-height:48px !important;min-width:48px !important;min-inline-size:48px !important;margin-inline:4px;line-height:48px}
    }
    /* --- Fix 3D/Safari --- */
.list-inline-item i,
.list-inline-item .skill-image{
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  transform-style: preserve-3d;
}

/* --- Animations utilisées au tap --- */
@keyframes spinY {
  to { transform: rotateY(360deg) scale(1.2); }
}
@keyframes spin2D {
  to { transform: rotate(360deg) scale(1.2); }
}

/* Classe appliquée par JS au tap */
.tap-spinY { 
  animation: spinY 0.6s cubic-bezier(0.175,0.885,0.32,1.275);
  filter: brightness(1.2) drop-shadow(0 0 15px rgba(100,255,218,.6));
  color:#fff;
}
.tap-spin {
  animation: spin2D 0.6s cubic-bezier(0.175,0.885,0.32,1.275);
  filter: brightness(1.2) drop-shadow(0 0 15px rgba(100,255,218,.6));
  color:#fff;
}

/* Respecte l’accessibilité */
@media (prefers-reduced-motion: reduce){
  .tap-spinY, .tap-spin { animation: none !important; }
}

  </style>

  <!-- Open Graph -->
  {{ $preview_image := .Resources.GetMatch "site_preview" }}
  {{ if $preview_image }}
    <meta property="og:image" content="{{ $preview_image.Permalink }}">
    <meta property="og:title" content="{{ $preview_image.Title }}">
  {{ else }}
    <meta property="og:image" content="{{ .Site.Params.profileImage | absURL }}">
    <meta property="og:title" content="{{ .Site.Title }} | {{ .Title }}">
  {{ end }}
  <meta property="og:description" content="{{ if .IsHome }}{{ .Site.Params.description }}{{else}}{{ .Description }}{{ end }}">
  <meta name="author" content="{{ .Site.Params.firstName }} {{ .Site.Params.lastName }}">

  <!-- CSS externes -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Saira+Extra+Condensed:wght@100;200;300;400;500;600;700;800;900&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Saira+Extra+Condensed:wght@100;200;300;400;500;600;700;800;900&display=swap"></noscript>

  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"></noscript>

  <link rel="preload" href="{{ "css/resume-override.css" | absURL }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ "css/resume-override.css" | absURL }}"></noscript>

  <!-- Devicons legacy + new -->
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/devicons/1.8.0/css/devicons.min.css" integrity="sha512-JW3fT0YTK7pT7w437SoX6GcW76jOZ6E0jGmrqBAcloC4GKT+njHOY4fX5KxJ9WfIXTkNrAF994525fAHp+KCxg==" crossorigin="anonymous" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/devicons/1.8.0/css/devicons.min.css" integrity="sha512-JW3fT0YTK7pT7w437SoX6GcW76jOZ6E0jGmrqBAcloC4GKT+njHOY4fX5KxJ9WfIXTkNrAF994525fAHp+KCxg==" crossorigin="anonymous"></noscript>

  <link rel="preload" href="{{ "css/devicon.css" | absURL }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ "css/devicon.css" | absURL }}"></noscript>

  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css" integrity="sha512-QKC1UZ/ZHNgFzVKSAhV5v5j73eeL9EEN289eKAEFaAjgAiobVAnVv/AGuPbXsKl1dNoel3kNr6PYnSiTzVVBCw==" crossorigin="anonymous" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css" integrity="sha512-QKC1UZ/ZHNgFzVKSAhV5v5j73eeL9EEN289eKAEFaAjgAiobVAnVv/AGuPbXsKl1dNoel3kNr6PYnSiTzVVBCw==" crossorigin="anonymous"></noscript>

  <!-- thèmes persos (optionnels si distincts) -->
  <link rel="preload" href="{{ "css/vanta-bg.css" | absURL }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ "css/vanta-bg.css" | absURL }}"></noscript>
  <link rel="preload" href="{{ "css/tweaks.css" | absURL }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ "css/tweaks.css" | absURL }}"></noscript>

  <!-- Schema.org -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Organization",
    "name":"Ilyes Khedhiri",
    "url":"https://ilyesk.com",
    "logo":"https://ilyesk.com/favicon.png"
  }
  </script>

  {{ hugo.Generator }}
  {{ block "headfiles" . }}{{ end }}
</head>

<body id="page-top">
  <!-- Canvas déplacé dans le body -->
  <canvas id="nn-canvas" data-bg='{{ "img/bgneural.png" | absURL }}'></canvas>

  {{ partial "nav.html" . }}

  <div class="container-fluid p-0">
    {{ block "main" . }}{{ .Content }}{{ end }}

    <section><span style="color:#999"></span>
      {{ with $.GitInfo }}{{ with $.Site.Params.gitCommitPrefix }} |
        <span style="color:#999">Page content generated from commit:
          <a href="{{ . }}/{{ $.GitInfo.AbbreviatedHash }}" title="log: {{ $.GitInfo.Subject }}">{{ $.GitInfo.AbbreviatedHash }}</a>
        </span>
      {{ end }}{{ end }}
    </section>
  </div>

  <!-- JS -->
  <script src="https://code.jquery.com/jquery-3.6.4.slim.min.js" integrity="sha256-a2yjHM4jnF9f54xUQakjZGaqYs/V1CYvWpoqZzC2/Bw=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

  <!-- Smooth scroll polyfills -->
  <script src="https://unpkg.com/smoothscroll-polyfill@0.4.4/dist/smoothscroll.min.js" integrity="sha384-EYn4rWu1DHvYD0sSSSbMEtXQmMl58CFJd897806+RT1jJVYbhuZlZMN6yG9nCyFa" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/smoothscroll-anchor-polyfill@1.3.2/dist/index.min.js" integrity="sha384-EY9NBEHCFbZANmPcTm7CgG8OhsFILy0VBLG85pF6OIpP42NVbZVNsFOc23PYTCkB" crossorigin="anonymous"></script>

  <!-- Animation d’apparition via IO -->
  <script>
    document.addEventListener('DOMContentLoaded',function(){
      const items=document.querySelectorAll('.list-inline-item');
      if('IntersectionObserver' in window){
        const io=new IntersectionObserver((entries,obs)=>{
          entries.forEach(entry=>{
            if(entry.isIntersecting){
              entry.target.classList.add('visible');
              obs.unobserve(entry.target);
            }
          });
        },{threshold:0.1,rootMargin:'20px'});
        items.forEach(i=>io.observe(i));
      }else{
        // fallback
        items.forEach(i=>i.classList.add('visible'));
      }
    });
  </script>

  <!-- Canvas anim -->
  <script src='{{ "/js/nn-anim.js" | relURL }}' defer></script>

  <script async src="/js/resume.js"></script>
  <script>
  // Tap-to-spin sur mobile + support clavier (Enter/Espace)
  document.addEventListener('DOMContentLoaded', function () {
    const cards = document.querySelectorAll('.list-inline-item');

    cards.forEach((card) => {
      const icon = card.querySelector('i, .skill-image');
      if (!icon) return;

      // Choix 3D si supporté, sinon 2D (iOS anciens)
      const use3D = CSS && CSS.supports && CSS.supports('transform-style','preserve-3d');

      const trigger = () => {
        // Reset pour relancer l’anim si on retape rapidement
        icon.classList.remove('tap-spinY','tap-spin');
        // reflow
        void icon.offsetWidth;
        icon.classList.add(use3D ? 'tap-spinY' : 'tap-spin');
      };

      // Pointer (couvre touch + mouse)
      card.addEventListener('pointerdown', trigger, { passive: true });

      // Clavier (accessibilité)
      card.setAttribute('tabindex','0'); // focusable si non-lien
      card.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          trigger();
        }
      });

      // Nettoyage à la fin de l’anim
      icon.addEventListener('animationend', () => {
        icon.classList.remove('tap-spinY','tap-spin');
      });
    });
  });
</script>


  {{ if .Site.Params.google.analytics.trackerID }}
  <script async src="https://www.googletagmanager.com/gtag/js?id={{ .Site.Params.google.analytics.trackerID }}"></script>
  <script>
    window.dataLayer=window.dataLayer||[];
    function gtag(){dataLayer.push(arguments);}
    gtag('js',new Date());
    gtag('config','{{ .Site.Params.google.analytics.trackerID }}');
  </script>
  {{ end }}

  {{ block "footerfiles" . }}{{ end }}
</body>
</html>
